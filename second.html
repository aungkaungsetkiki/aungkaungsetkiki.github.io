<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>(2D Ledger Web appllication)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .input-section, .diinput-section {
            margin-bottom: 20px;
        }
        .input-row, .diinput-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            align-items: flex-end;
        }
        .input-group, .diinput-group {
            flex: 1;
            min-width: 120px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, button {
            padding: 8px;
            width: 100%;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        button#function-btn, button#difunction-btn {
            background-color: #2196F3;
        }
        button.danger {
            background-color: #f44336;
        }
        #r-money-group, #ahkays-group, #dir-money-group, #diahkays-group {
            display: none;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            margin-bottom: 10px;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 6px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
            position: sticky;
            top: 0;
        }
        .main-entry {
            background-color: #e8f5e9;
        }
        .r-entry {
            background-color: #fff8e1;
        }
        .identical-entry {
            background-color: #e1f5fe;
        }
        .prefix-entry {
            background-color: #f3e5f5;
        }
        .suffix-entry {
            background-color: #e8f5e9;
        }
        .break-entry {
            background-color: #ffebee;
        }
        .power-entry {
            background-color: #e8eaf6;
        }
        .nacca-entry {
            background-color: #e0f7fa;
        }
        .ahkway-entry {
            background-color: #fce4ec;
        }
        .ahput-par-ahkway-entry {
            background-color: #f3e5f5;
        }
        .function-list, .difunction-list {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 150px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }
        .function-list a, .difunction-list a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        .function-list a:hover, .difunction-list a:hover {
            background-color: #f1f1f1;
        }
        .show {
            display: block;
        }
        .summary {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            flex-wrap: wrap;
            gap: 10px;
        }
        .summary-box {
            background-color: #e9f7ef;
            padding: 10px;
            border-radius: 5px;
            flex: 1;
            min-width: 200px;
            text-align: center;
        }
        .over-limit {
            color: red;
            font-weight: bold;
        }
        .over-limit-cell {
            background-color: #ffdddd;
        }
        .total-cell {
            background-color: #e3f2fd;
            font-weight: bold;
        }
        .total-ledger-row {
            background-color: #e3f2fd;
            font-weight: bold;
            text-align: center;
            padding: 8px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .table-container {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .table-container table {
            margin: 0;
        }
    </style>
    
    <style>
    .calculation-section {
        margin-top: 20px;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 10px;
        border: 1px solid #ddd;
    }

    .calculation-results {
        margin-top: 15px;
    }

    .calculation-results p {
        margin: 5px 0;
        font-size: 16px;
    }

    #result-status {
        font-weight: bold;
        font-size: 18px;
        margin-top: 10px;
    }

    /* CSS ထဲမှာ ဒီ style တွေကို ထပ်ထည့်ပါ */
    .overbuy-modal {
        display: none;
        position: fixed;
        z-index: 100;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.7);
    }

    .overbuy-modal-content {
        background-color: #fefefe;
        margin: 10% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 1000px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .close-modal {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    }

    .close-modal:hover {
        color: black;
    }

    /* CSS ထဲမှာ ဒီ style တွေကို ထပ်ထည့်ပါ */
    .ledger-modal {
        display: none;
        position: fixed;
        z-index: 100;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.7);
    }

    .ledger-modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 90%;
        max-width: 1000px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        max-height: 80vh;
        overflow-y: auto;
    }

    .close-ledger-modal {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    }

    .close-ledger-modal:hover {
        color: black;
    }

    /* CSS ထဲမှာ ဒီ style ကို ထပ်ထည့်ပါ */
    #number-sequence-table tfoot {
        display: none;
    }

    .di-list-entry {
        background-color: #e8eaf6;

// Add this CSS for highlighting

.highlighted-number {
    background-color: #ffeb3b !important;
    font-weight: bold;
    box-shadow: 0 0 0 2px #ff9800;

    }
#di-total-money {
    font-weight: bold;
    color: #2196F3;
    font-size: 1.2em;
}
  /* Add this new style for highlighted DI entries */
        .highlighted-di {
            background-color: #FFEB3B !important;
            font-weight: bold;
            border: 2px solid #FF9800;
        }

    /* Add this new style for highlighted entries */
        .highlighted-entry {
            background-color: #FFEB3B !important;
            font-weight: bold;
            border: 2px solid #FF9800;
        }

</style>

</head>
<body>
    <div class="container">
        <h1>2D Ledger Web Application</h1>
        
        <!-- List Table -->
        <h2>List Table</h2>
        <div class="table-container">
            <table id="list-table">
                <thead>
                    <tr>
                        <th>Number</th>
                        <th>Money</th>
                        <th>Type</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data will appear here -->
                </tbody>
            </table>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="input-row">
                <div class="input-group">
                    <label for="number-input">Number</label>
                    <input type="number" id="number-input" maxlength="2" placeholder="00-99" pattern="[0-9]{2}">
                </div>
                <div class="input-group">
                    <label for="function-input">Function Sign</label>
                    <input type="text" id="function-input" placeholder="/ for reverse">
                </div>
                <div class="input-group">
                    <label for="money-input">Money</label>
                    <input type="number" id="money-input" min="0" placeholder="0">
                </div>
                <div class="input-group" id="r-money-group">
                    <label for="r-money-input">R Money</label>
                    <input type="number" id="r-money-input" min="0" placeholder="0">
                </div>
                <div class="input-group" id="ahkays-group">
                    <label for="ahkays-input">Ahkays Numbers</label>
                    <input type="text" id="ahkays-input" placeholder="e.g. 012">
                </div>
            </div>
            <div class="input-row">
                <div class="function-selector">
                    <button id="function-btn">ဒဲ့</button>
                    <div id="function-list" class="function-list">
                        <a>ဒဲ့</a>
                        <a>ဆတူအာ</a>
                        <a>အပူး</a>
                        <a>အပါ</a>
                        <a>ဘရိတ်</a>
                        <a>ပါဝါ</a>
                        <a>နက္ခ</a>
                        <a>ထိပ်</a>
                        <a>ပိတ်</a>
                        <a>ညီကို</a>
                        <a>ကိုညီ</a>
                        <a>အခွေ</a>
                        <a>အပူးပါအခွေ</a>
                    </div>
                </div>
                <button id="save-btn">Save (Enter)</button>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="summary">
            <div class="summary-box">
                <h3>Total Money</h3>
                <p id="total-money">0</p>
            </div>
            <div class="summary-box">
                <h3>Break Money Limit</h3>
                <input type="number" id="break-limit" min="0" value="1000000">
                <button id="apply-limit-btn">Apply</button>
            </div>
            <div class="summary-box">
                <h3>Over Limit Total</h3>
                <p id="over-limit-total">0</p>
            </div>
        </div>

        <div class="overbuy-section">
            <button id="overbuy-btn">Overbuy</button>
            <div id="overbuy-modal" class="overbuy-modal">
                <div class="overbuy-modal-content">
                    <span class="close-modal">&times;</span>
                  <!--  <h2>Overbuy List</h2>-->
                    <div class="table-container">
                        <table id="overbuy-list-table">
                            <thead>
                                <tr>
                                    <th>Number</th>
                                    <th>Over Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data will appear here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- DI Input Section -->
                    <div class="diinput-section">
                        <div class="diinput-row">
                            <div class="diinput-group">
                                <label for="dinumber-input">DI Number</label>
                                <input type="number" id="dinumber-input" maxlength="2" placeholder="00-99" pattern="[0-9]{2}">
                            </div>
                            <div class="diinput-group">
                                <label for="difunction-input">DI Function</label>
                                <input type="text" id="difunction-input" placeholder="/ for reverse">
                            </div>
                            <div class="diinput-group">
                                <label for="dimoney-input">DI Money</label>
                                <input type="number" id="dimoney-input" min="0" placeholder="0">
                            </div>
                            <div class="diinput-group" id="dir-money-group">
                                <label for="dir-money-input">DI R Money</label>
                                <input type="number" id="dir-money-input" min="0" placeholder="0">
                            </div>
                            <div class="diinput-group" id="diahkays-group">
                                <label for="diahkays-input">DI Ahkays</label>
                                <input type="text" id="diahkays-input" placeholder="e.g. 012">
                            </div>
                        </div>
                        <div class="diinput-row">
                            <div class="difunction-selector">
                                <button id="difunction-btn">ဒဲ့</button>
                                <div id="difunction-list" class="difunction-list">
                                    <a>ဒဲ့</a>
                                    <a>ဆတူအာ</a>
                                    <a>အပူး</a>
                                    <a>အပါ</a>
                                    <a>ဘရိတ်</a>
                                    <a>ပါဝါ</a>
                                    <a>နက္ခ</a>
                                    <a>ထိပ်</a>
                                    <a>ပိတ်</a>
                                    <a>ညီကို</a>
                                    <a>ကိုညီ</a>
                                    <a>အခွေ</a>
                                    <a>အပူးပါအခွေ</a>
                                </div>
                            </div>
                            <button id="disave-btn">DI Save (Enter)</button>
                        </div>
                    </div>
   <div class="total-ledger-row">
            DiTotal Money: <span id="di-total-money">0</span>
        </div>
                    <!--<h3>Di List Table</h3>-->
                    <div class="table-container">
                        <table id="di-list-table">
                            <thead>
                                <tr>
                                    <th>DI Number</th>
                                    <th>DI Money</th>
                                    <th>DI Type</th>
                                    <th>DI Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Over Limit Table -->
        <div class="table-container">
            <table id="over-limit-table">
                <thead>
                    <tr>
                        <th>Number</th>
                        <th>Original Amount</th>
                        <th>Over Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data will appear here -->
                </tbody>
            </table>
        </div>

        <button id="ledger-btn">Ledger</button>

        <!-- Number Sequence Table Modal -->
        <div id="ledger-modal" class="ledger-modal">
            <div class="ledger-modal-content">
                <span class="close-ledger-modal">&times;</span>
                <h2>Number Sequence Table</h2>
                <div class="table-container">
                    <table id="number-sequence-table">
                        <!-- Table content will be generated by JavaScript -->
                    </table>
                </div>
            </div>
        </div>

        <!-- Number Sequence Table with Totals -->
        <div class="table-container">
            <table id="number-sequence-table">
                <thead>
                    <tr id="header-row">
                        <!-- Will be populated by JavaScript -->
                    </tr>
                </thead>
                <tbody>
                    <!-- Will be populated by JavaScript -->
                </tbody>
                <tfoot id="footer-row">
                   <!-- Total row will be added here -->
                </tfoot>
            </table>
        </div>


        
        <!-- Total Ledger Money splay -->
        <div class="total-ledger-row">
            Total Ledger Money: <span id="total-ledger-money">0</span>
        </div>
<div class="total-ledger-row">
            တင်ကြေး: <span id="di-total-money-display">0</span>
        </div>
<div class="total-ledger-row">
            ရောင်းကြေးစုပေါင်း: <span id="total-money-display">0</span>
        </div>

    </div>
    </div>
  
    

    <div class="calculation-section">
        <h2>Profit/Loss Calculation</h2>
<div class="input-group">
    <label for="pnumber-input">P Number</label>
    <input type="number" id="pnumber-input" maxlength="2" placeholder="00-99" pattern="[0-9]{2}">
</div>
        <div class="input-row">
            <div class="input-group">
                <label for="commission-input">Commission (%)</label>
                <input type="number" id="commission-input" min="0" placeholder="0">
            </div>
            <div class="input-group">
                <label for="multiplier-input">Multiplier</label>
                <input type="number" id="multiplier-input" min="0" placeholder="0">
            </div>
            <div class="input-group">
                <label for="payout-input">Payout</label>
                <input type="number" id="payout-input" min="0" placeholder="0">
            </div>
     <!-- Add this new display for DI total -->
            <div class="input-group">
                <label for="di-total-display">DI Total for Number</label>
                <input type="number" id="di-total-display" placeholder="0" readonly>
            </div>
            <div class="input-group">
                <label for="main-total-display">Main Total</label>
                <input type="number" id="main-total-display" placeholder="0" readonly>
            </div>

        </div>
        </div>
        <div class="calculation-results">
            <p>Total Ledger Money: <span id="display-total-ledger-money">0</span></p>
            <p>Commission Amount: <span id="commission-amount">0</span></p>
            <p>After Commission: <span id="after-commission">0</span></p>
            <p>After Payout: <span id="after-payout">0</span></p>
            <p>Profit/Loss: <span id="profit-loss">0</span></p>
            <p id="result-status"></p>
        </div>
    </div>

    <button id="clear-all-btn" class="danger">Clear All Data</button>

<script>
    // DOM Elements
    const numberInput = document.getElementById('number-input');
    const functionInput = document.getElementById('function-input');
    const moneyInput = document.getElementById('money-input');
    const rMoneyGroup = document.getElementById('r-money-group');
    const rMoneyInput = document.getElementById('r-money-input');
    const ahkaysGroup = document.getElementById('ahkays-group');
    const ahkaysInput = document.getElementById('ahkays-input');
    const functionBtn = document.getElementById('function-btn');
    const saveBtn = document.getElementById('save-btn');
    const functionList = document.getElementById('function-list');
    const listTable = document.getElementById('list-table').getElementsByTagName('tbody')[0];
    const overLimitTable = document.getElementById('over-limit-table').getElementsByTagName('tbody')[0];
    const numberSequenceTable = document.getElementById('number-sequence-table');
    const headerRow = document.getElementById('header-row');
    const footerRow = document.getElementById('footer-row');
    const totalMoneyEl = document.getElementById('total-money');
    const breakLimitInput = document.getElementById('break-limit');
    const applyLimitBtn = document.getElementById('apply-limit-btn');
    const overLimitTotalEl = document.getElementById('over-limit-total');
    const clearAllBtn = document.getElementById('clear-all-btn');
    const totalLedgerMoneyEl = document.getElementById('total-ledger-money');
    const commissionInput = document.getElementById('commission-input');
    const multiplierInput = document.getElementById('multiplier-input');
    const payoutInput = document.getElementById('payout-input');
    const displayTotalLedgerMoney = document.getElementById('display-total-ledger-money');
    const commissionAmount = document.getElementById('commission-amount');
    const afterCommission = document.getElementById('after-commission');
    const afterPayout = document.getElementById('after-payout');
    const profitLoss = document.getElementById('profit-loss');
    const resultStatus = document.getElementById('result-status');
    
    // DI Input Elements
    const diNumberInput = document.getElementById('dinumber-input');
    const diFunctionInput = document.getElementById('difunction-input');
    const diMoneyInput = document.getElementById('dimoney-input');
    const diRMoneyGroup = document.getElementById('dir-money-group');
    const diRMoneyInput = document.getElementById('dir-money-input');
    const diAhkaysGroup = document.getElementById('diahkays-group');
    const diAhkaysInput = document.getElementById('diahkays-input');
    const diFunctionBtn = document.getElementById('difunction-btn');
    const diSaveBtn = document.getElementById('disave-btn');
    const diFunctionList = document.getElementById('difunction-list');
    const diListTable = document.getElementById('di-list-table').getElementsByTagName('tbody')[0];
    const ditotalMoneyEl = document.getElementById('di-total-money');
    // Data
    let numberMoneyData = JSON.parse(localStorage.getItem('numberMoneyData')) || [];
    let diNumberMoneyData = JSON.parse(localStorage.getItem('diNumberMoneyData')) || [];
    let breakLimit = parseInt(localStorage.getItem('breakLimit')) || 1000000;
    let entryCounter = 1;

    // Initialize the app
    function initApp() {
        breakLimitInput.value = breakLimit;
        renderAllTables();
        renderDIListTable();
        updateTotalMoney();
updateDITotalMoney();
        numberInput.focus();
    }

    // Auto-focus flow for main input
    numberInput.addEventListener('input', function() {
        if (this.value.length === 2) {
            functionInput.focus();
        }
    });

    // Auto-focus flow for DI input
    diNumberInput.addEventListener('input', function() {
        if (this.value.length === 2) {
            diFunctionInput.focus();
        }
    });

    functionInput.addEventListener('input', function() {
        updateFunctionsplay(this.value, rMoneyGroup, ahkaysGroup, functionBtn);
    });

    diFunctionInput.addEventListener('input', function() {
        updateFunctionsplay(this.value, diRMoneyGroup, diAhkaysGroup, diFunctionBtn);
    });

    function updateFunctionsplay(funcSign, rMoneyGroup, ahkaysGroup, functionBtn) {
        if (funcSign.includes('/')) {
            rMoneyGroup.style.display = 'block';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'ဆတူအာ';
            functionBtn.style.backgroundColor = '#4CAF50';
            moneyInput.focus();
        } else if (funcSign.includes('+')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'အပူး';
            functionBtn.style.backgroundColor = '#FF9800';
            moneyInput.focus();
        } else if (funcSign.includes('a')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'အပါ';
            functionBtn.style.backgroundColor = '#9C27B0';
            moneyInput.focus();
        } else if (funcSign.includes('b')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'ဘရိတ်';
            functionBtn.style.backgroundColor = '#607d8b';
            moneyInput.focus();
        } else if (funcSign.includes('p')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'ပါဝါ';
            functionBtn.style.backgroundColor = '#5C6BC0';
            moneyInput.focus();
        } else if (funcSign.includes('k')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'နက္ခ';
            functionBtn.style.backgroundColor = '#26A69A';
            moneyInput.focus();
        } else if (funcSign.includes('t')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'ထိပ်';
            functionBtn.style.backgroundColor = '#FF5722';
            moneyInput.focus();
        } else if (funcSign.includes('d')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'ပိတ်';
            functionBtn.style.backgroundColor = '#795548';
            moneyInput.focus();
        } else if (funcSign.includes('sg')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'ညီကို';
            functionBtn.style.backgroundColor = '#EC407A';
            moneyInput.focus();
        } else if (funcSign.includes('gs')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'ကိုညီ';
            functionBtn.style.backgroundColor = '#AB47BC';
            moneyInput.focus();
        } else if (funcSign.includes('x')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'block';
            functionBtn.textContent = 'အခွေ';
            functionBtn.style.backgroundColor = '#8D6E63';
            moneyInput.focus();
        } else if (funcSign.includes('z')) {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'block';
            functionBtn.textContent = 'အပူးပါအခွေ';
            functionBtn.style.backgroundColor = '#7E57C2';
            moneyInput.focus();
        } else {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.textContent = 'ဒဲ့';
            functionBtn.style.backgroundColor = '#2196F3';
        }
    }

    // Function list toggle
    functionBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        functionList.classList.toggle('show');
    });

    // DI Function list toggle
    diFunctionBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        diFunctionList.classList.toggle('show');
    });

    // Select function from list
    document.querySelectorAll('.function-list a').forEach(item => {
        item.addEventListener('click', function() {
            selectFunction(this.textContent, functionInput, functionBtn, rMoneyGroup, ahkaysGroup);
        });
    });

    // Select DI function from list
    document.querySelectorAll('.difunction-list a').forEach(item => {
        item.addEventListener('click', function() {
            selectFunction(this.textContent, diFunctionInput, diFunctionBtn, diRMoneyGroup, diAhkaysGroup);
        });
    });

    function selectFunction(text, functionInput, functionBtn, rMoneyGroup, ahkaysGroup) {
        functionInput.value = text;
        functionBtn.textContent = text;
        functionList.classList.remove('show');
        diFunctionList.classList.remove('show');
        
        if (text === 'ဆတူအာ') {
            functionInput.value = '/';
            rMoneyGroup.style.display = 'block';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#4CAF50';
            moneyInput.focus();
        } else if (text === 'အပူး') {
            functionInput.value = '+';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#FF9800';
            moneyInput.focus();
        } else if (text === 'အပါ') {
            functionInput.value = 'a';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#9C27B0';
            moneyInput.focus();
        } else if (text === 'ဘရိတ်') {
            functionInput.value = 'b';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#607d8b';
            moneyInput.focus();
        } else if (text === 'ပါဝါ') {
            functionInput.value = 'p';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#5C6BC0';
            moneyInput.focus();
        } else if (text === 'နက္ခ') {
            functionInput.value = 'k';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#26A69A';
            moneyInput.focus();
        } else if (text === 'ထိပ်') {
            functionInput.value = 't';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#FF5722';
            moneyInput.focus();
        } else if (text === 'ပိတ်') {
            functionInput.value = 'd';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#795548';
            moneyInput.focus();
        } else if (text === 'ညီကို') {
            functionInput.value = 'sg';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#EC407A';
            moneyInput.focus();
        } else if (text === 'ကိုညီ') {
            functionInput.value = 'gs';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#AB47BC';
            moneyInput.focus();
        } else if (text === 'အခွေ') {
            functionInput.value = 'x';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'block';
            functionBtn.style.backgroundColor = '#8D6E63';
            moneyInput.focus();
        } else if (text === 'အပူးပါအခွေ') {
            functionInput.value = 'z';
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'block';
            functionBtn.style.backgroundColor = '#7E57C2';
            moneyInput.focus();
        } else {
            rMoneyGroup.style.display = 'none';
            ahkaysGroup.style.display = 'none';
            functionBtn.style.backgroundColor = '#2196F3';
        }
    }

    // Close function list when clicking outside
    window.addEventListener('click', function() {
        functionList.classList.remove('show');
        diFunctionList.classList.remove('show');
    });

    // Reverse number digits (12 -> 21)
    function reverseNumber(num) {
        return num.split('').reverse().join('');
    }

    // Get all numbers with same first digit (for 't' - ထိပ်)
    function getPrefixNumbers(number) {
        const prefix = number.charAt(0);
        let numbers = [];
        
        for (let i = 0; i < 10; i++) {
            numbers.push(prefix + i);
        }
        
        return numbers;
    }

    // Get all numbers with same first or second digit (for 'a' - အပါ)
    function getAPANumbers(number) {
        const firstgit = number.charAt(0);
        const secondgit = number.charAt(1);
        let numbers = new Set();
        
        for (let i = 0; i < 10; i++) {
            numbers.add(firstgit + i);
        }
        
        for (let i = 0; i < 10; i++) {
            numbers.add(i + secondgit);
        }
        
        return Array.from(numbers);
    }

    // Get all numbers with same last digit (for 'd' - ပိတ်)
    function getSuffixNumbers(number) {
        const suffix = number.charAt(1);
        let numbers = [];
        
        for (let i = 0; i < 10; i++) {
            numbers.push(i.toString() + suffix);
        }
        
        return numbers;
    }

    // Get all numbers where last digit of sum equals last digit of input number's sum
    function getBreakNumbers(number) {
        const digit1 = parseInt(number.charAt(0));
        const digit2 = parseInt(number.charAt(1));
        const sum = digit1 + digit2;
        const lastgit = sum % 10;
        
        let numbers = [];
        
        for (let i = 0; i < 10; i++) {
            for (let j = 0; j < 10; j++) {
                if ((i + j) % 10 === lastgit) {
                    const num = i.toString() + j.toString();
                    numbers.push(num);
                }
            }
        }
        
        return numbers;
    }

    // Get all power numbers (05, 16, 27, 38, 49, 50, 61, 72, 83, 94)
    function getPowerNumbers() {
        return ['05', '16', '27', '38', '49', '50', '61', '72', '83', '94'];
    }

    // Get all nacca numbers (07, 18, 24, 35, 42, 53, 69, 70, 81, 96)
    function getNaccaNumbers() {
        return ['07', '18', '24', '35', '42', '53', '69', '70', '81', '96'];
    }

    // Get brother numbers (01, 12, 23, 34, 45, 56, 67, 78, 89, 90)
    function getBrotherNumbers() {
        return ['01', '12', '23', '34', '45', '56', '67', '78', '89', '90'];
    }

    // Get reverse brother numbers (10, 21, 32, 43, 54, 65, 76, 87, 98, 09)
    function getReverseBrotherNumbers() {
        return ['10', '21', '32', '43', '54', '65', '76', '87', '98', '09'];
    }

    // Get all possible 2-digit combinations from a string of digits (for Ahkway)
    function getAhkwayNumbers(digits) {
        let numbers = new Set();
        
        for (let i = 0; i < digits.length; i++) {
            for (let j = 0; j < digits.length; j++) {
                if (i !== j) {
                    numbers.add(digits[i] + digits[j]);
                }
            }
        }
        
        return Array.from(numbers);
    }

    // Get all possible 2-digit combinations including identical numbers (for Ahput Par Ahkway)
    function getAhputParAhkwayNumbers(digits) {
        let numbers = new Set();
        
        for (let i = 0; i < digits.length; i++) {
            for (let j = 0; j < digits.length; j++) {
                numbers.add(digits[i] + digits[j]);
            }
        }
        
        return Array.from(numbers);
    }

    // Calculate total money for a number (including DI entries)
    function calculateMoneyForNumber(number) {
        const mainMoney = numberMoneyData
            .filter(item => item.number === number)
            .reduce((sum, item) => sum + parseInt(item.money), 0);
        
        const diMoney = diNumberMoneyData
            .filter(item => item.number === number)
            .reduce((sum, item) => sum - parseInt(item.money), 0); // Subtract DI money
        
        return mainMoney + diMoney;
    }
// Calculate total DI money
function calculateDITotalMoney() {
    return diNumberMoneyData.reduce((sum, item) => sum + parseInt(item.money), 0);
}

// Update DI total money display
function updateDITotalMoney() {
    document.getElementById('di-total-money').textContent = calculateDITotalMoney();
document.getElementById('di-total-money-display').textContent = calculateDITotalMoney();

}

    // Render all tables
    function renderAllTables() {
        renderListTable();
        renderDIListTable();
        renderNumberSequenceTable();
        updateOverLimitTable();
    }

    // Render list table
    function renderListTable() {
        listTable.innerHTML = '';
        entryCounter = 1;
        
        numberMoneyData.forEach((item, index) => {
            const row = listTable.insertRow();
            if (item.type === 'Main') row.classList.add('main-entry');
            if (item.type === 'Reversed') row.classList.add('r-entry');
            if (item.type === 'Identical') row.classList.add('identical-entry');
            if (item.type === 'Prefix') row.classList.add('prefix-entry');
            if (item.type === 'Suffix') row.classList.add('suffix-entry');
            if (item.type === 'Break') row.classList.add('break-entry');
            if (item.type === 'Power') row.classList.add('power-entry');
            if (item.type === 'Nacca') row.classList.add('nacca-entry');
            if (item.type === 'APa') row.classList.add('prefix-entry');
            if (item.type === 'Brother') row.classList.add('brother-entry');
            if (item.type === 'ReverseBrother') row.classList.add('reverse-brother-entry');
            if (item.type === 'Ahkway') row.classList.add('ahkway-entry');
            if (item.type === 'Ahput Par Ahkway') row.classList.add('ahput-par-ahkway-entry');
            
            row.insertCell(0).textContent = item.number;
            row.insertCell(1).textContent = item.money;
            row.insertCell(2).textContent = item.type || 'Normal';
            
            const actionsCell = row.insertCell(3);
            
            const editBtn = document.createElement('button');
            editBtn.textContent = 'Edit';
            editBtn.addEventListener('click', () => editItem(index));
            actionsCell.appendChild(editBtn);
            
            const deleteBtn = document.createElement('button');
            deleteBtn.textContent = 'Delete';
            deleteBtn.classList.add('danger');
            deleteBtn.addEventListener('click', () => deleteItem(index));
            actionsCell.appendChild(deleteBtn);
        });
    }

    // Render DI list table
    function renderDIListTable() {
        diListTable.innerHTML = '';
        
        diNumberMoneyData.forEach((item, index) => {
            const row = diListTable.insertRow();
            row.classList.add('di-list-entry');
            
            row.insertCell(0).textContent = item.number;
            row.insertCell(1).textContent = item.money;
            row.insertCell(2).textContent = item.type || 'DI Normal';
            
            const actionsCell = row.insertCell(3);
            
            const editBtn = document.createElement('button');
            editBtn.textContent = 'Edit';
            editBtn.addEventListener('click', () => editDIItem(index));
            actionsCell.appendChild(editBtn);
            
            const deleteBtn = document.createElement('button');
            deleteBtn.textContent = 'Delete';
            deleteBtn.classList.add('danger');
            deleteBtn.addEventListener('click', () => deleteDIItem(index));
            actionsCell.appendChild(deleteBtn);
        });
    }

    function renderNumberSequenceTable() {
        const table = document.getElementById('number-sequence-table');
        table.innerHTML = '';
        
        // Create header
        const headerRow = table.createTHead().insertRow();
        for (let i = 0; i < 10; i++) {
            headerRow.appendChild(document.createElement('th')).textContent = 'Number';
            headerRow.appendChild(document.createElement('th')).textContent = 'Money';
        }
        
        // Create body
        const tbody = table.createTBody();
        const columnTotals = Array(10).fill(0);
        let grandTotal = 0;
        
        for (let rowNum = 0; rowNum < 10; rowNum++) {
            const row = tbody.insertRow();
            
            for (let colNum = 0; colNum < 10; colNum++) {
                const number = (colNum * 10 + rowNum).toString().padStart(2, '0');
                const totalMoney = calculateMoneyForNumber(number);
                const displayMoney = totalMoney > breakLimit ? breakLimit : totalMoney;
                
                // Number cell
                row.insertCell().textContent = number;
                
                // Money cell
                const moneyCell = row.insertCell();
                moneyCell.textContent = displayMoney;
                
                if (totalMoney > breakLimit) {
                    moneyCell.classList.add('over-limit-cell');
                }
                
                // Add to column total and grand total
                columnTotals[colNum] += displayMoney;
                grandTotal += displayMoney;
            }
        }
        
        // Create footer
        const tfoot = table.createTFoot();
        const footer = tfoot.insertRow();
        footer.insertCell().textContent = 'Total';
        footer.insertCell().classList.add('total-cell');
        
        for (let colNum = 0; colNum < 10; colNum++) {
            footer.insertCell().textContent = columnTotals[colNum];
            footer.insertCell().classList.add('total-cell');
        }
        
        // Update grand total display
        totalLedgerMoneyEl.textContent = grandTotal;
    }

    // Update over limit table
    function updateOverLimitTable() {
        overLimitTable.innerHTML = '';
        let overLimitTotal = 0;
        
        for (let i = 0; i < 100; i++) {
            const number = i.toString().padStart(2, '0');
            const totalMoney = calculateMoneyForNumber(number);
            
            if (totalMoney > breakLimit) {
                const overAmount = totalMoney - breakLimit;
                overLimitTotal += overAmount;
                
                const row = overLimitTable.insertRow();
                row.insertCell(0).textContent = number;
                row.insertCell(1).textContent = totalMoney;
                row.insertCell(2).textContent = overAmount;
            }
        }
        
        overLimitTotalEl.textContent = overLimitTotal;
    }

    // Update total money
    function updateTotalMoney() {
        const total = numberMoneyData.reduce((sum, item) => sum + parseInt(item.money), 0);
        totalMoneyEl.textContent = total;
document.getElementById('total-money-display').textContent = total;
    }

    // Save data
    function saveData() {
        const number = numberInput.value;
        const money = (moneyInput.value)*100;
        const rMoney = (rMoneyInput.value)*100;
        const ahkays = ahkaysInput.value;

        if (!number || number.length !== 2 || isNaN(number)) {
            alert('Please enter a valid 2-digit number');
            numberInput.focus();
            return;
        }

        if (!money || isNaN(money) || money < 0) {
            alert('Please enter a valid money amount');
            moneyInput.focus();
            return;
        }

        const funcSign = functionInput.value;
        if (funcSign.includes('/')) {
            // Add main entry
            numberMoneyData.push({
                number: number,
                money: money,
                type: 'Main'
            });
            
            // Add reversed entry
            const reversedNumber = reverseNumber(number);
            const rMoneyValue = rMoney && !isNaN(rMoney) ? rMoney : money;
            numberMoneyData.push({
                number: reversedNumber,
                money: rMoneyValue,
                type: 'Reversed'
            });
        } else if (funcSign.includes('+')) {
            // Add entries for all identical numbers (00, 11, 22, etc.)
            for (let i = 0; i < 10; i++) {
                const identicalNumber = i.toString() + i.toString();
                numberMoneyData.push({
                    number: identicalNumber,
                    money: money,
                    type: 'Identical'
                });
            }
        } else if (funcSign.includes('a')) {
            // Add entries for all numbers with same first OR second digit (အပါ)
            const apaNumbers = getAPANumbers(number);
            apaNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'APa'
                });
            });
        } else if (funcSign.includes('t')) {
            // Add entries for all numbers with same first digit (ထိပ်)
            const prefixNumbers = getPrefixNumbers(number);
            prefixNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'Prefix'
                });
            });
        } else if (funcSign.includes('d')) {
            // Add entries for all numbers with same last digit (ပိတ်)
            const suffixNumbers = getSuffixNumbers(number);
            suffixNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'Suffix'
                });
            });
        } else if (funcSign.includes('b')) {
            // Add entries for all numbers where sum of digits has same last digit
            const breakNumbers = getBreakNumbers(number);
            breakNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'Break'
                });
            });
        } else if (funcSign.includes('p')) {
            // Add entries for all power numbers
            const powerNumbers = getPowerNumbers();
            powerNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'Power'
                });
            });
        } else if (funcSign.includes('k')) {
            // Add entries for all nacca numbers
            const naccaNumbers = getNaccaNumbers();
            naccaNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'Nacca'
                });
            });
        } else if (funcSign.includes('sg')) {
            // Add entries for all brother numbers (01, 12, 23, etc.)
            const brotherNumbers = getBrotherNumbers();
            brotherNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'Brother'
                });
            });
        } else if (funcSign.includes('gs')) {
            // Add entries for all reverse brother numbers (10, 21, 32, etc.)
            const reverseBrotherNumbers = getReverseBrotherNumbers();
            reverseBrotherNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'ReverseBrother'
                });
            });
        } else if (funcSign.includes('x')) {
            // Add entries for all Ahkway combinations
            if (!ahkays || ahkays.length < 2) {
                alert('Please enter at least 2 digits for Ahkway');
                ahkaysInput.focus();
                return;
            }
            
            const ahkwayNumbers = getAhkwayNumbers(ahkays);
            ahkwayNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'Ahkway'
                });
            });
        } else if (funcSign.includes('z')) {
            // Add entries for all Ahput Par Ahkway combinations
            if (!ahkays || ahkays.length < 2) {
                alert('Please enter at least 2 digits for Ahput Par Ahkway');
                ahkaysInput.focus();
                return;
            }
            
            const ahputParAhkwayNumbers = getAhputParAhkwayNumbers(ahkays);
            ahputParAhkwayNumbers.forEach(num => {
                numberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'Ahput Par Ahkway'
                });
            });
        } else {
            // Add single entry
            numberMoneyData.push({
                number: number,
                money: money,
                type: 'Normal'
            });
        }

        // Save to localStorage
        localStorage.setItem('numberMoneyData', JSON.stringify(numberMoneyData));
        
        // Clear inputs and update UI
        clearInputs();
        renderAllTables();
        updateTotalMoney();
updateDITotalMoney();
         
        const tableContainer = document.querySelector('.table-container');
        if (tableContainer) {
            tableContainer.scrollTop = tableContainer.scrollHeight;
        }
    }

    // Save DI data
    function saveDIData() {
        const number = diNumberInput.value;
        const money = (diMoneyInput.value)*100;
        const rMoney = (diRMoneyInput.value)*100;
        const ahkays = diAhkaysInput.value;

        if (!number || number.length !== 2 || isNaN(number)) {
            alert('Please enter a valid 2-digit number');
            diNumberInput.focus();
            return;
        }

        if (!money || isNaN(money) || money < 0) {
            alert('Please enter a valid money amount');
            diMoneyInput.focus();
            return;
        }

        const funcSign = diFunctionInput.value;
        if (funcSign.includes('/')) {
            // Add main DI entry
            diNumberMoneyData.push({
                number: number,
                money: money,
                type: 'DI Main'
            });
            
            // Add reversed DI entry
            const reversedNumber = reverseNumber(number);
            const rMoneyValue = rMoney && !isNaN(rMoney) ? rMoney : money;
            diNumberMoneyData.push({
                number: reversedNumber,
                money: rMoneyValue,
                type: 'DI Reversed'
            });
        } else if (funcSign.includes('+')) {
            // Add DI entries for all identical numbers (00, 11, 22, etc.)
            for (let i = 0; i < 10; i++) {
                const identicalNumber = i.toString() + i.toString();
                diNumberMoneyData.push({
                    number: identicalNumber,
                    money: money,
                    type: 'DI Identical'
                });
            }
        } else if (funcSign.includes('a')) {
            // Add DI entries for all numbers with same first OR second digit (အပါ)
            const apaNumbers = getAPANumbers(number);
            apaNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI APa'
                });
            });
        } else if (funcSign.includes('t')) {
            // Add DI entries for all numbers with same first digit (ထိပ်)
            const prefixNumbers = getPrefixNumbers(number);
            prefixNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI Prefix'
                });
            });
        } else if (funcSign.includes('d')) {
            // Add DI entries for all numbers with same last digit (ပိတ်)
            const suffixNumbers = getSuffixNumbers(number);
            suffixNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI Suffix'
                });
            });
        } else if (funcSign.includes('b')) {
            // Add DI entries for all numbers where sum of digits has same last digit
            const breakNumbers = getBreakNumbers(number);
            breakNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI Break'
                });
            });
        } else if (funcSign.includes('p')) {
            // Add DI entries for all power numbers
            const powerNumbers = getPowerNumbers();
            powerNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI Power'
                });
            });
        } else if (funcSign.includes('k')) {
            // Add DI entries for all nacca numbers
            const naccaNumbers = getNaccaNumbers();
            naccaNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI Nacca'
                });
            });
        } else if (funcSign.includes('sg')) {
            // Add DI entries for all brother numbers (01, 12, 23, etc.)
            const brotherNumbers = getBrotherNumbers();
            brotherNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI Brother'
                });
            });
        } else if (funcSign.includes('gs')) {
            // Add DI entries for all reverse brother numbers (10, 21, 32, etc.)
            const reverseBrotherNumbers = getReverseBrotherNumbers();
            reverseBrotherNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI ReverseBrother'
                });
            });
        } else if (funcSign.includes('x')) {
            // Add DI entries for all Ahkway combinations
            if (!ahkays || ahkays.length < 2) {
                alert('Please enter at least 2 digits for Ahkway');
                diAhkaysInput.focus();
                return;
            }
            
            const ahkwayNumbers = getAhkwayNumbers(ahkays);
            ahkwayNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI Ahkway'
                });
            });
        } else if (funcSign.includes('z')) {
            // Add DI entries for all Ahput Par Ahkway combinations
            if (!ahkays || ahkays.length < 2) {
                alert('Please enter at least 2 digits for Ahput Par Ahkway');
                diAhkaysInput.focus();
                return;
            }
            
            const ahputParAhkwayNumbers = getAhputParAhkwayNumbers(ahkays);
            ahputParAhkwayNumbers.forEach(num => {
                diNumberMoneyData.push({
                    number: num,
                    money: money,
                    type: 'DI Ahput Par Ahkway'
                });
            });
        } else {
            // Add single DI entry
            diNumberMoneyData.push({
                number: number,
                money: money,
                type: 'DI Normal'
            });
        }

        // Save to localStorage
        localStorage.setItem('diNumberMoneyData', JSON.stringify(diNumberMoneyData));
        
        // Clear DI inputs and update UI
        clearDIInputs();
        renderAllTables();
        updateTotalMoney();
updateDITotalMoney();
renderOverbuyList();
    }

    // Edit item
    function editItem(index) {
        const item = numberMoneyData[index];
        
        // Populate form with selected item data
        numberInput.value = item.number;
        moneyInput.value = (item.money)/100;
        functionInput.value = '';
        rMoneyGroup.style.display = 'none';
        ahkaysGroup.style.display = 'none';
        functionBtn.textContent = 'ဒဲ့';
        functionBtn.style.backgroundColor = '#2196F3';

        // Adjust function based on entry type
        if (item.type === 'Main') {
            functionInput.value = '';
            rMoneyGroup.style.display = 'block';
            functionBtn.textContent = 'ဆတူအာ';
            functionBtn.style.backgroundColor = '#4CAF50';
            
            // Look for reversed entry but don't auto-delete
            const reversedNumber = reverseNumber(item.number);
            const reversedEntry = numberMoneyData.find(entry => 
                entry.number === reversedNumber && entry.type === 'Reversed'
            );
            
            if (reversedEntry) {
                rMoneyInput.value = reversedEntry.money;
            }
        } else if (item.type === 'Identical') {
            functionInput.value = '';
            functionBtn.textContent = 'အပူး';
            functionBtn.style.backgroundColor = '#FF9800';
        }
        // ... other types ...

        // Remove only the selected item
        numberMoneyData.splice(index, 1);

        // Update storage and UI
        localStorage.setItem('numberMoneyData', JSON.stringify(numberMoneyData));
        renderAllTables();
        updateTotalMoney();
updateDITotalMoney();
        numberInput.focus();
    }

    // Edit DI item
    function editDIItem(index) {
        const item = diNumberMoneyData[index];
        
        // Populate form with selected item data
        diNumberInput.value = item.number;
        diMoneyInput.value = (item.money)/100;
        diFunctionInput.value = '';
        diRMoneyGroup.style.display = 'none';
        diAhkaysGroup.style.display = 'none';
        diFunctionBtn.textContent = 'ဒဲ့';
        diFunctionBtn.style.backgroundColor = '#2196F3';

        // Adjust function based on entry type
        if (item.type === 'DI Main') {
            diFunctionInput.value = '';
            diRMoneyGroup.style.display = 'block';
            diFunctionBtn.textContent = 'ဆတူအာ';
            diFunctionBtn.style.backgroundColor = '#4CAF50';
            
            // Look for reversed entry but don't auto-delete
            const reversedNumber = reverseNumber(item.number);
            const reversedEntry = diNumberMoneyData.find(entry => 
                entry.number === reversedNumber && entry.type === 'DI Reversed'
            );
            
            if (reversedEntry) {
                diRMoneyInput.value = reversedEntry.money;
            }
        } else if (item.type === 'DI Identical') {
            diFunctionInput.value = '';
            diFunctionBtn.textContent = 'အပူး';
            diFunctionBtn.style.backgroundColor = '#FF9800';
        }
        // ... other types ...

        // Remove only the selected item
        diNumberMoneyData.splice(index, 1);

        // Update storage and UI
        localStorage.setItem('diNumberMoneyData', JSON.stringify(diNumberMoneyData));
        renderAllTables();
        updateTotalMoney();
updateDITotalMoney();
        diNumberInput.focus();
    }

    // Delete item
    function deleteItem(index) {
        if (confirm('Are you sure you want to delete this item?')) {
            const item = numberMoneyData[index];
            
            // Remove only the selected item
            numberMoneyData.splice(index, 1);
            
            // Update local storage
            localStorage.setItem('numberMoneyData', JSON.stringify(numberMoneyData));
            renderAllTables();
            updateTotalMoney();
updateDITotalMoney();
        }
    }

    // Delete DI item
    function deleteDIItem(index) {
        if (confirm('Are you sure you want to delete this DI item?')) {
            const item = diNumberMoneyData[index];
            
            // Remove only the selected item
            diNumberMoneyData.splice(index, 1);
            
            // Update local storage
            localStorage.setItem('diNumberMoneyData', JSON.stringify(diNumberMoneyData));
            renderAllTables();
            updateTotalMoney();
updateDITotalMoney();
        }
    }

    // Apply break limit
    function applyBreakLimit() {
        const newLimit = parseInt(breakLimitInput.value);
        
        if (isNaN(newLimit) || newLimit < 0) {
            alert('Please enter a valid positive number');
            return;
        }
        
        breakLimit = newLimit;
        localStorage.setItem('breakLimit', breakLimit.toString());
        
        renderNumberSequenceTable();
        updateOverLimitTable();
    }

    // Overbuy modal အတွက် function
    document.getElementById('overbuy-btn').addEventListener('click', function() {
        // Hide all other elements
        document.querySelectorAll('.container > *:not(.overbuy-section)').forEach(el => {
            el.style.display = 'none';
        });
        
        // Show modal
        document.getElementById('overbuy-modal').style.display = 'block';
        
        // Populate overbuy list
        renderOverbuyList();
    });

    // Close modal
    document.querySelector('.close-modal').addEventListener('click', function() {
        document.getElementById('overbuy-modal').style.display = 'none';
        
        // Show all elements again
        document.querySelectorAll('.container > *').forEach(el => {
            el.style.display = '';
        });
    });

    // Render overbuy list
    function renderOverbuyList() {
        const table = document.getElementById('overbuy-list-table').getElementsByTagName('tbody')[0];
        table.innerHTML = '';
        
        for (let i = 0; i < 100; i++) {
            const number = i.toString().padStart(2, '0');
            const totalMoney = calculateMoneyForNumber(number);
            
            if (totalMoney > breakLimit) {
                const overAmount = totalMoney - breakLimit;
                
                const row = table.insertRow();
                row.insertCell(0).textContent = number;
                row.insertCell(1).textContent = overAmount;
            }
        }
    }

    // Clear all data
    function clearAllData() {
        if (confirm('Are you sure you want to delete ALL data? This cannot be undone.')) {
            numberMoneyData = [];
            diNumberMoneyData = [];
            breakLimit = 1000000;
            breakLimitInput.value = '1000000';
            
            localStorage.removeItem('numberMoneyData');
            localStorage.removeItem('diNumberMoneyData');
            localStorage.removeItem('breakLimit');
            
            clearInputs();
            clearDIInputs();
            renderAllTables();
            updateTotalMoney();
updateDITotalMoney();
        }
    }

    // Clear input fields
    function clearInputs() {
        numberInput.value = '';
        functionInput.value = '';
        moneyInput.value = '';
        rMoneyInput.value = '';
        ahkaysInput.value = '';
        rMoneyGroup.style.display = 'none';
        ahkaysGroup.style.display = 'none';
        functionBtn.textContent = 'ဒဲ့';
        functionBtn.style.backgroundColor = '#2196F3';
        numberInput.focus();
    }

    // Clear DI input fields
    function clearDIInputs() {
        diNumberInput.value = '';
        diFunctionInput.value = '';
        diMoneyInput.value = '';
        diRMoneyInput.value = '';
        diAhkaysInput.value = '';
        diRMoneyGroup.style.display = 'none';
        diAhkaysGroup.style.display = 'none';
        diFunctionBtn.textContent = 'ဒဲ့';
        diFunctionBtn.style.backgroundColor = '#2196F3';
        diNumberInput.focus();
    }

    // Function to Update Calculations
    function updateCalculations() {
        // Get values from inputs
        const totalLedgerMoney = parseFloat(totalLedgerMoneyEl.textContent) || 0;
        const commission = parseFloat(commissionInput.value) || 0;
        const multiplier = parseFloat(multiplierInput.value) || 0;
        const payout = parseFloat(payoutInput.value) || 0;

        // splay Total Ledger Money
        displayTotalLedgerMoney.textContent = totalLedgerMoney;

        // Calculate Commission Amount
        const commissionValue = (totalLedgerMoney * commission) / 100;
        commissionAmount.textContent = commissionValue.toFixed();

        // Calculate After Commission
        const afterCommissionValue = totalLedgerMoney - commissionValue;
        afterCommission.textContent = afterCommissionValue.toFixed();

        // Calculate After Payout
        const afterPayoutValue = afterCommissionValue - (payout * multiplier);
        afterPayout.textContent = afterPayoutValue.toFixed();

        // Calculate Profit/Loss
        profitLoss.textContent = afterPayoutValue.toFixed();

        // Determine Result Status
        if (afterPayoutValue < 0) {
            resultStatus.textContent = "Loss";
            resultStatus.style.color = "red";
        } else {
            resultStatus.textContent = "Profit";
            resultStatus.style.color = "green";
        }
    }

    // DOM Elements for ledger modal
    const ledgerBtn = document.getElementById('ledger-btn');
    const ledgerModal = document.getElementById('ledger-modal');
    const closeLedgerModal = document.querySelector('.close-ledger-modal');

    // Show ledger modal
    ledgerBtn.addEventListener('click', function() {
        // Make sure the table is rendered before showing
        renderNumberSequenceTable();
        ledgerModal.style.display = 'block';
    });

    // Close ledger modal
    closeLedgerModal.addEventListener('click', function() {
        ledgerModal.style.display = 'none';
    });

    // Close modal when clicking outside
    window.addEventListener('click', function(event) {
        if (event.target === ledgerModal) {
            ledgerModal.style.display = 'none';
        }
    });

    // Event listeners
    saveBtn.addEventListener('click', saveData);
    diSaveBtn.addEventListener('click', saveDIData);
    applyLimitBtn.addEventListener('click', applyBreakLimit);
    clearAllBtn.addEventListener('click', clearAllData);
    commissionInput.addEventListener('input', updateCalculations);
    multiplierInput.addEventListener('input', updateCalculations);
    payoutInput.addEventListener('input', updateCalculations);

    // Handle Enter key for main input
    moneyInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveData();
    });
    
    rMoneyInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveData();
    });

    ahkaysInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveData();
    });

    // Handle Enter key for DI input
    diMoneyInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveDIData();
    });
    
    diRMoneyInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveDIData();
    });

    diAhkaysInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveDIData();
    });

    // Hide Overbuy List Table and Number Sequence Table
    document.getElementById('over-limit-table').style.display = 'none';
    document.getElementById('number-sequence-table').style.display = '';

 // Add this new function to calculate DI total for a specific number
        function calculateDITotalForNumber(number) {
            return diNumberMoneyData
                .filter(item => item.number === number)
                .reduce((sum, item) => sum + parseInt(item.money), 0);
        }

        // Add this new function to highlight DI entries in the table
        function highlightDIEntries(number) {
            // Remove previous highlights
            const diRows = document.querySelectorAll('#di-list-table tr');
            diRows.forEach(row => {
                row.classList.remove('highlighted-di');
            });

            // Highlight matching DI entries
            diNumberMoneyData.forEach((item, index) => {
                if (item.number === number) {
                    const row = diListTable.rows[index];
                    if (row) row.classList.add('highlighted-di');
                }
            });
        }

     // Add this new function to calculate main list total for a specific number
        function calculateMainTotalForNumber(number) {
            return numberMoneyData
                .filter(item => item.number === number)
                .reduce((sum, item) => sum + parseInt(item.money), 0);
        }

        // Add this new function to highlight main list entries
        function highlightMainEntries(number) {
            // Remove previous highlights
            const mainRows = document.querySelectorAll('#list-table tr');
            mainRows.forEach(row => {
                row.classList.remove('highlighted-entry');
            });

            // Highlight matching main entries
            numberMoneyData.forEach((item, index) => {
                if (item.number === number) {
                    const row = listTable.rows[index];
                    if (row) row.classList.add('highlighted-entry');
                }
            });
        }





   // pnumber input change event listener
document.getElementById('pnumber-input').addEventListener('input', function() {
    const pnumber = this.value.padStart(2, '0');
    
    if(pnumber.length === 2) {
        // Calculate money for this number from sequence table
        const totalMoney = calculateMoneyForNumber(pnumber);
             const diMoney = calculateDITotalForNumber(pnumber);
  const mainMoney = calculateMainTotalForNumber(pnumber);

        // Fill the payout input
        document.getElementById('payout-input').value = totalMoney;
        document.getElementById('di-total-display').value = diMoney;
document.getElementById('main-total-display').value = mainMoney;
        // Highlight the number in sequence table (optional)
        highlightNumberInSequenceTable(pnumber);
highlightDIEntries(pnumber);
highlightMainEntries(pnumber);
const firstHighlighted = document.querySelector('.highlighted-entry');
                if (firstHighlighted) {
                    firstHighlighted.scrollIntoView({behavior: 'smooth', block: 'center'});
                }



    }
});

// Helper function to highlight number in sequence table
function highlightNumberInSequenceTable(number) {
    // Remove previous highlights
    document.querySelectorAll('#number-sequence-table td').forEach(cell => {
        cell.classList.remove('highlighted-number');
    });
    
    // Find and highlight the cell
    const cells = document.querySelectorAll('#number-sequence-table td');
    for(let cell of cells) {
        if(cell.textContent === number) {
            cell.classList.add('highlighted-number');
            cell.scrollIntoView({behavior: 'smooth', block: 'center'});
            break;
        }
    }
}

function calculateMoneyForNumber(number) {
    // Calculate from both main data and DI data
    const mainMoney = numberMoneyData
        .filter(item => item.number === number)
        .reduce((sum, item) => sum + parseInt(item.money), 0);
    
    const diMoney = diNumberMoneyData
        .filter(item => item.number === number)
        .reduce((sum, item) => sum - parseInt(item.money), 0);
    
    return mainMoney + diMoney;
}
 // Initialize app and calculations
    initApp();
    updateCalculations();
</script>

</body>
</html>
